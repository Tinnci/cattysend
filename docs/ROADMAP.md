# Cattysend å¼€å‘è·¯çº¿å›¾

> äº’ä¼ è”ç›Ÿåè®® Linux å®ç°

## é¡¹ç›®çŠ¶æ€æ€»è§ˆ

| é˜¶æ®µ | çŠ¶æ€ | å®Œæˆåº¦ |
|------|------|--------|
| Phase 1: æ ¸å¿ƒåè®® | âœ… å®Œæˆ | 100% |
| Phase 2: CLI/Daemon æ¶æ„ | âœ… å®Œæˆ | 100% |
| Phase 3: TUI äº¤äº’ç•Œé¢ | âœ… å®Œæˆ | 100% |
| Phase 4: çœŸå® BLE é›†æˆ | ğŸ”„ è¿›è¡Œä¸­ | 80% |
| Phase 5: WiFi P2P å®ç° | ğŸ”„ è¿›è¡Œä¸­ | 70% |
| Phase 6: GUI æ‰˜ç›˜åº”ç”¨ | â³ å¾…å¼€å§‹ | 0% |

---

## Phase 1: æ ¸å¿ƒåè®® âœ…

**ç›®æ ‡**: å®ç°ä¸ CatShare (Android) å®Œå…¨å…¼å®¹çš„åè®®å±‚

### å·²å®Œæˆ
- [x] BLE UUID å¸¸é‡å®šä¹‰
- [x] DeviceInfo ç»“æ„ä½“ (state/key/mac/catShare)
- [x] P2pInfo ç»“æ„ä½“ (id/ssid/psk/mac/port/key/catShare)
- [x] ECDH (P-256) å¯†é’¥äº¤æ¢
- [x] AES-256-CTR åŠ å¯†/è§£å¯†
- [x] æ­£ç¡®çš„ IV: ASCII `"0102030405060708"`
- [x] ç›´æ¥ä½¿ç”¨ ECDH å…±äº«å¯†é’¥ (æ—  HKDF)

### æµ‹è¯•è¦†ç›–
- [x] åŠ å¯†/è§£å¯†å¾€è¿”æµ‹è¯•
- [x] IV æ ¼å¼éªŒè¯æµ‹è¯•

---

## Phase 2: CLI/Daemon æ¶æ„ âœ…

**ç›®æ ‡**: å®ç°å®ˆæŠ¤è¿›ç¨‹ + CLI å®¢æˆ·ç«¯æ¨¡å¼

### å·²å®Œæˆ
- [x] Cargo Workspace ç»“æ„
- [x] `cattysend-core` æ ¸å¿ƒåº“
- [x] `cattysend-daemon` systemd æœåŠ¡
- [x] `cattysend-cli` clap å‘½ä»¤è¡Œ
- [x] Unix Domain Socket IPC
- [x] `xtask` è‡ªåŠ¨åŒ–å·¥å…·

### xtask å‘½ä»¤
| å‘½ä»¤ | åŠŸèƒ½ |
|------|------|
| `cargo xtask build` | æ„å»º release ç‰ˆæœ¬ |
| `cargo xtask install` | å®‰è£… systemd æœåŠ¡ |
| `cargo xtask uninstall` | å¸è½½æœåŠ¡ |
| `cargo xtask setup-caps` | è®¾ç½®å… sudo æƒé™ |
| `cargo xtask dist` | æ‰“åŒ…å‘å¸ƒ |

---

## Phase 3: TUI äº¤äº’ç•Œé¢ âœ…

**ç›®æ ‡**: ä½¿ç”¨ ratatui æä¾›äº¤äº’å¼ç»ˆç«¯ä½“éªŒ

### å·²å®Œæˆ
- [x] è®¾å¤‡åˆ—è¡¨é¢æ¿
- [x] RSSI ä¿¡å·å¼ºåº¦æ¡æ˜¾ç¤º
- [x] ä¼ è¾“è¿›åº¦æ¡
- [x] æ—¥å¿—é¢æ¿
- [x] Tab é¡µåˆ‡æ¢
- [x] é”®ç›˜å¿«æ·é”®

### å¿«æ·é”®
| æŒ‰é”® | åŠŸèƒ½ |
|------|------|
| `s` | æ‰«æè®¾å¤‡ |
| `r` | æ¥æ”¶æ¨¡å¼ |
| `â†‘/â†“` | é€‰æ‹©è®¾å¤‡ |
| `Enter` | è¿æ¥ |
| `Tab` | åˆ‡æ¢æ ‡ç­¾ |
| `q` | é€€å‡º |

---

## Phase 4: çœŸå® BLE é›†æˆ ğŸ”„

**ç›®æ ‡**: è¿æ¥çœŸå®çš„ BLE ç¡¬ä»¶

### å·²å®Œæˆ âœ…
- [x] BLE æ‰«æé›†æˆ (btleplug)
  - `BleScanner`: æ‰«æå¸¦æœ‰ SERVICE_UUID çš„è®¾å¤‡
  - `DiscoveredDevice`: è®¾å¤‡åç§°ã€åœ°å€ã€RSSIã€å“ç‰Œ ID
- [x] GATT æœåŠ¡å‘ç°
- [x] CHAR_STATUS è¯»å–
  - è¯»å– DeviceInfo JSONï¼ŒåŒ…å«å¯¹æ–¹å…¬é’¥
- [x] CHAR_P2P å†™å…¥
  - åŠ å¯† P2pInfo å¹¶å†™å…¥
- [x] BLE å¹¿æ’­ (bluer GATT Server)
  - `GattServer`: å®Œæ•´çš„ GATT Server å®ç°
  - STATUS ç‰¹å¾åªè¯»ï¼Œè¿”å› DeviceInfo
  - P2P ç‰¹å¾å¯å†™ï¼Œæ¥æ”¶åŠ å¯†çš„ P2pInfo
- [x] è®¾å¤‡è¿‡æ»¤ (Service UUID `00003331-...`)
- [x] BLE å®¢æˆ·ç«¯ (`BleClient`)
  - è¿æ¥åˆ°æ¥æ”¶ç«¯
  - è¯»å– DeviceInfo
  - ECDH å¯†é’¥åå•†
  - åŠ å¯†å¹¶å†™å…¥ P2pInfo

### å¾…å®Œæˆ
- [ ] å®Œæ•´çš„ç«¯åˆ°ç«¯æµ‹è¯• (éœ€è¦ç¡¬ä»¶)
- [ ] é”™è¯¯æ¢å¤å’Œé‡è¯•æœºåˆ¶
- [ ] è¿æ¥çŠ¶æ€ç›‘æ§

### æŠ€æœ¯æŒ‘æˆ˜
- BlueZ æƒé™é…ç½® (`CAP_NET_ADMIN`)
- D-Bus ä¼šè¯ç®¡ç†
- è·¨å‘è¡Œç‰ˆå…¼å®¹æ€§

---

## Phase 5: WiFi P2P å®ç° ğŸ”„

**ç›®æ ‡**: ä½¿ç”¨ wpa_supplicant åˆ›å»º/åŠ å…¥ P2P ç»„

### å·²å®Œæˆ âœ…
- [x] WiFi P2P å‘é€ç«¯ (`WiFiP2pSender`)
  - wpa_cli P2P group åˆ›å»º
  - nmcli çƒ­ç‚¹å¤‡ç”¨æ–¹æ¡ˆ
  - éšæœº SSID/PSK ç”Ÿæˆ
  - MAC åœ°å€è·å–
- [x] WiFi P2P æ¥æ”¶ç«¯ (`WiFiP2pReceiver`)  
  - wpa_cli è¿æ¥
  - nmcli è¿æ¥å¤‡ç”¨
  - IP åœ°å€è·å–

### å¾…å®Œæˆ
- [ ] wpa_supplicant D-Bus æ¥å£ (æ›´å¯é )
- [ ] DHCP æœåŠ¡å™¨é…ç½® (dnsmasq)
- [ ] è¿æ¥çŠ¶æ€ç›‘æ§
- [ ] 5GHz é¢‘æ®µä¼˜å…ˆé€‰æ‹©

### ä¾èµ–
- `wpa_supplicant` >= 2.10
- NetworkManager æˆ–æ‰‹åŠ¨é…ç½®
- `CAP_NET_ADMIN` æƒé™

---

## Phase 6: GUI æ‰˜ç›˜åº”ç”¨ â³

**ç›®æ ‡**: æä¾›ç±»ä¼¼ AirDrop çš„æ¡Œé¢ä½“éªŒ

### æ–¹æ¡ˆé€‰æ‹©
| æ¡†æ¶ | ä¼˜åŠ¿ | é€‚ç”¨åœºæ™¯ |
|------|------|----------|
| **Slint** | è½»é‡ã€åŸç”Ÿæ¸²æŸ“ | æ‰˜ç›˜å¸¸é©» |
| **Tauri** | WebViewã€ç”Ÿæ€ä¸°å¯Œ | å¤æ‚ UI |
| **Iced** | çº¯ Rustã€Elm æ¶æ„ | æ€§èƒ½æè‡´ |

### å¾…å®Œæˆ
- [ ] ç³»ç»Ÿæ‰˜ç›˜å›¾æ ‡
- [ ] æ¡Œé¢é€šçŸ¥
- [ ] æ‹–æ‹½å‘é€
- [ ] æ–‡ä»¶æ¥æ”¶ç¡®è®¤å¼¹çª—
- [ ] è®¾ç½®ç•Œé¢
- [ ] æš—è‰²/äº®è‰²ä¸»é¢˜

---

## æ–‡ä»¶ä¼ è¾“åè®® âœ…

**ç›®æ ‡**: ä¸ CatShare å®Œå…¨å…¼å®¹çš„ HTTP/WebSocket ä¼ è¾“

### å·²å®Œæˆ
- [x] WebSocket æ¶ˆæ¯åè®® (`type:id:name?payload` æ ¼å¼)
  - `WsMessage` ç»“æ„ä½“
  - ç‰ˆæœ¬åå•† (`versionNegotiation`)
  - å‘é€è¯·æ±‚ (`sendRequest`)
  - çŠ¶æ€æ›´æ–° (`status`)
- [x] ä¼ è¾“æœåŠ¡å™¨ (`TransferServer`)
  - HTTP/HTTPS æœåŠ¡
  - WebSocket å¤„ç†
  - ZIP æ–‡ä»¶æ‰“åŒ…
- [x] æ¥æ”¶å®¢æˆ·ç«¯ (`ReceiverClient`)
  - TLS è¿æ¥ (è·³è¿‡è¯ä¹¦éªŒè¯)
  - WebSocket åå•†
  - ZIP è§£å‹

### å¾…å®Œæˆ
- [ ] HTTPS è¯ä¹¦ç”Ÿæˆ
- [ ] ä¼ è¾“è¿›åº¦å›è°ƒ
- [ ] æ–­ç‚¹ç»­ä¼ 

---

## æŠ€æœ¯å€ºåŠ¡ & æ”¹è¿›

### å½“å‰é—®é¢˜
1. ~~**TUI è®¾å¤‡æ¨¡æ‹Ÿ**: å½“å‰ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ï¼Œéœ€è¿æ¥çœŸå® BLE~~ âœ… å·²å®ç° BLE æ‰«æ
2. ~~**P2P çƒ­ç‚¹**: å½“å‰ä¸ºæ¨¡æ‹Ÿå®ç°ï¼Œéœ€ wpa_supplicant é›†æˆ~~ âœ… å·²å®ç°
3. **é”™è¯¯å¤„ç†**: éƒ¨åˆ†é”™è¯¯ç›´æ¥ panicï¼Œéœ€æ”¹ä¸ºä¼˜é›…é™çº§

### ä»£ç è´¨é‡
- [ ] æ·»åŠ æ›´å¤šå•å…ƒæµ‹è¯•
- [ ] é›†æˆæµ‹è¯• (éœ€è¦ç¡¬ä»¶)
- [x] API æ–‡æ¡£ (rustdoc)
- [ ] ç¤ºä¾‹ä»£ç 

---

## è´¡çŒ®æŒ‡å—

### å¼€å‘ç¯å¢ƒ
```bash
# å…‹éš†
git clone https://github.com/user/cattysend

# æ„å»º
cargo xtask build

# å¼€å‘æ¨¡å¼
cargo xtask dev

# è¿è¡Œ TUI
cargo run -p cattysend-tui
```

### æäº¤è§„èŒƒ
- `feat:` æ–°åŠŸèƒ½
- `fix:` ä¿®å¤
- `refactor:` é‡æ„
- `docs:` æ–‡æ¡£
- `test:` æµ‹è¯•

---

## æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        cattysend-core                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     ble     â”‚   crypto    â”‚    wifi     â”‚      transfer       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ BleScanner  â”‚ BleSecurity â”‚ WiFiP2p-    â”‚ TransferServer      â”‚
â”‚ BleClient   â”‚ SessionCiph â”‚   Sender    â”‚ ReceiverClient      â”‚
â”‚ GattServer  â”‚   er        â”‚ WiFiP2p-    â”‚ WsMessage           â”‚
â”‚             â”‚             â”‚   Receiver  â”‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â–¼               â–¼               â–¼
        cattysend-cli   cattysend-tui   cattysend-daemon
```

---

**æœ€åæ›´æ–°**: 2026-01-09
